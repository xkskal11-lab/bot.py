--================= إعدادات أساسية =================--
local player = game.Players.LocalPlayer
local PlayerGui = player:WaitForChild("PlayerGui")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

-- حفظ التقييمات في جدول دائم
local ratings = {}

--================= واجهة رئيسية =================--
local mainGui = Instance.new("ScreenGui")
mainGui.Name = "SZHUB_GUI"
mainGui.ResetOnSpawn = false
mainGui.Parent = PlayerGui

-- زر SZHUB أعلى الشاشة
local hubBtn = Instance.new("TextButton")
hubBtn.Size = UDim2.new(0,140,0,40)
hubBtn.Position = UDim2.new(0.5,-70,0,10)
hubBtn.BackgroundColor3 = Color3.fromRGB(0,120,255)
hubBtn.Text = "SZHUB"
hubBtn.Font = Enum.Font.SourceSansBold
hubBtn.TextSize = 20
hubBtn.TextColor3 = Color3.fromRGB(255,255,255)
hubBtn.Parent = mainGui

-- إطار القوائم
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0,240,0,320)
mainFrame.Position = UDim2.new(0.5,-120,0.5,-160)
mainFrame.BackgroundColor3 = Color3.fromRGB(30,30,30)
mainFrame.BorderSizePixel = 0
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.Visible = false
mainFrame.Parent = mainGui

hubBtn.MouseButton1Click:Connect(function()
	mainFrame.Visible = not mainFrame.Visible
end)

--================= أزرار التنقل العلوية =================--
local function createNavButton(name,posX)
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.new(0,70,0,25)
	btn.Position = UDim2.new(0,posX,0,5)
	btn.BackgroundColor3 = Color3.fromRGB(50,50,50)
	btn.TextColor3 = Color3.fromRGB(255,255,255)
	btn.TextSize = 14
	btn.Font = Enum.Font.SourceSansBold
	btn.Text = name
	btn.Parent = mainFrame
	return btn
end

local mainMenuBtn = createNavButton("الرئيسية",5)
local updatesBtn = createNavButton("التحديثات",80)
local rateBtn = createNavButton("ضع تقييمك",155)
local devBtn = createNavButton("التقييمات",230) -- يظهر للمطور فقط

if player.Name ~= "DEVSZ_STORE" then
	devBtn.Visible = false
end

--================= القوائم =================--
local pages = {}

-- القائمة الرئيسية
local mainPage = Instance.new("Frame")
mainPage.Size = UDim2.new(1,0,1,-35)
mainPage.Position = UDim2.new(0,0,0,35)
mainPage.BackgroundTransparency = 1
mainPage.Parent = mainFrame
pages["الرئيسية"] = mainPage

-- قائمة التحديثات
local updatesPage = Instance.new("Frame")
updatesPage.Size = UDim2.new(1,0,1,-35)
updatesPage.Position = UDim2.new(0,0,0,35)
updatesPage.BackgroundTransparency = 1
updatesPage.Visible = false
updatesPage.Parent = mainFrame
pages["التحديثات"] = updatesPage

local updatesLabel = Instance.new("TextLabel")
updatesLabel.Size = UDim2.new(1,0,1,0)
updatesLabel.BackgroundTransparency = 1
updatesLabel.Text = "شكراً لك على استخدام السكربت\n\nالتحديثات:\n1- تم التعديل على أغلب الأشياء\n2- تمت إضافة X-Ray\n3- تم تغيير الاسم لـ SZHUB"
updatesLabel.TextColor3 = Color3.fromRGB(255,255,255)
updatesLabel.Font = Enum.Font.SourceSansBold
updatesLabel.TextSize = 16
updatesLabel.TextWrapped = true
updatesLabel.Parent = updatesPage

-- قائمة ضع تقييمك
local ratePage = Instance.new("Frame")
ratePage.Size = UDim2.new(1,0,1,-35)
ratePage.Position = UDim2.new(0,0,0,35)
ratePage.BackgroundTransparency = 1
ratePage.Visible = false
ratePage.Parent = mainFrame
pages["ضع تقييمك"] = ratePage

local rateTitle = Instance.new("TextLabel")
rateTitle.Size = UDim2.new(1,0,0,30)
rateTitle.BackgroundTransparency = 1
rateTitle.Text = "مكان التقييم"
rateTitle.TextColor3 = Color3.fromRGB(255,255,0)
rateTitle.Font = Enum.Font.SourceSansBold
rateTitle.TextSize = 18
rateTitle.Parent = ratePage

local rateBox = Instance.new("TextBox")
rateBox.Size = UDim2.new(0.9,0,0,40)
rateBox.Position = UDim2.new(0.05,0,0.2,0)
rateBox.PlaceholderText = "اكتب تقييمك هنا!"
rateBox.Text = ""
rateBox.ClearTextOnFocus = false
rateBox.Font = Enum.Font.SourceSans
rateBox.TextSize = 18
rateBox.TextColor3 = Color3.fromRGB(0,0,0)
rateBox.BackgroundColor3 = Color3.fromRGB(255,255,255)
rateBox.Parent = ratePage

local sendRateBtn = Instance.new("TextButton")
sendRateBtn.Size = UDim2.new(0.4,0,0,30)
sendRateBtn.Position = UDim2.new(0.3,0,0.5,0)
sendRateBtn.Text = "إرسال"
sendRateBtn.BackgroundColor3 = Color3.fromRGB(0,170,255)
sendRateBtn.TextColor3 = Color3.fromRGB(255,255,255)
sendRateBtn.Font = Enum.Font.SourceSansBold
sendRateBtn.TextSize = 18
sendRateBtn.Parent = ratePage

-- قائمة التقييمات (للمطور)
local devPage = Instance.new("Frame")
devPage.Size = UDim2.new(1,0,1,-35)
devPage.Position = UDim2.new(0,0,0,35)
devPage.BackgroundTransparency = 1
devPage.Visible = false
devPage.Parent = mainFrame
pages["التقييمات"] = devPage

local scroll = Instance.new("ScrollingFrame")
scroll.Size = UDim2.new(1,0,1,0)
scroll.CanvasSize = UDim2.new(0,0,0,0)
scroll.ScrollBarThickness = 6
scroll.BackgroundTransparency = 1
scroll.Parent = devPage

-- وظيفة تحديث التقييمات
local function refreshRatings()
	scroll:ClearAllChildren()
	local y = 0
	for i,text in ipairs(ratings) do
		local lbl = Instance.new("TextLabel")
		lbl.Size = UDim2.new(1,-10,0,30)
		lbl.Position = UDim2.new(0,5,0,y)
		lbl.BackgroundTransparency = 1
		lbl.Text = i.."- "..text
		lbl.TextColor3 = Color3.fromRGB(255,255,255)
		lbl.TextSize = 16
		lbl.Font = Enum.Font.SourceSansBold
		lbl.TextXAlignment = Enum.TextXAlignment.Left
		lbl.Parent = scroll
		y = y + 35
	end
	scroll.CanvasSize = UDim2.new(0,0,0,y)
end

sendRateBtn.MouseButton1Click:Connect(function()
	local txt = rateBox.Text
	if txt ~= "" then
		table.insert(ratings, player.Name..": "..txt)
		rateBox.Text = ""
		refreshRatings()
	end
end)

--================= تغيير الصفحات =================--
local function showPage(name)
	for k,v in pairs(pages) do
		v.Visible = (k == name)
	end
end

mainMenuBtn.MouseButton1Click:Connect(function() showPage("الرئيسية") end)
updatesBtn.MouseButton1Click:Connect(function() showPage("التحديثات") end)
rateBtn.MouseButton1Click:Connect(function() showPage("ضع تقييمك") end)
devBtn.MouseButton1Click:Connect(function() showPage("التقييمات") end)

--================= أزرار القائمة الرئيسية =================--
local function createMainButton(text,posY)
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.new(0.8,0,0,35)
	btn.Position = UDim2.new(0.1,0,posY,0)
	btn.BackgroundColor3 = Color3.fromRGB(0,170,255)
	btn.TextColor3 = Color3.fromRGB(255,255,255)
	btn.Font = Enum.Font.SourceSansBold
	btn.TextSize = 18
	btn.Text = text
	btn.Parent = mainPage
	return btn
end

--================= نظام البارت =================--
local function createPartMenu(title)
	local gui = Instance.new("Frame")
	gui.Size = UDim2.new(0,200,0,100)
	gui.Position = UDim2.new(0.5,-100,0.5,-50)
	gui.BackgroundColor3 = Color3.fromRGB(40,40,40)
	gui.Visible = true
	gui.Parent = mainGui
	gui.Active = true
	gui.Draggable = true

	local toggleBtn = Instance.new("TextButton")
	toggleBtn.Size = UDim2.new(0.8,0,0,40)
	toggleBtn.Position = UDim2.new(0.1,0,0.3,0)
	toggleBtn.BackgroundColor3 = Color3.fromRGB(0,170,255)
	toggleBtn.TextColor3 = Color3.fromRGB(255,255,255)
	toggleBtn.TextSize = 18
	toggleBtn.Font = Enum.Font.SourceSansBold
	toggleBtn.Text = "تشغيل "..title
	toggleBtn.Parent = gui

	local building = false
	local liftPart
	local followConn

	local function stopBuilding()
		building = false
		if followConn then followConn:Disconnect() end
		if liftPart then liftPart:Destroy() end
		toggleBtn.Text = "تشغيل "..title
	end

	local function startBuilding()
		building = true
		local char = player.Character or player.CharacterAdded:Wait()
		local root = char:WaitForChild("HumanoidRootPart")
		local humanoid = char:WaitForChild("Humanoid")

		liftPart = Instance.new("Part")
		liftPart.Size = Vector3.new(6,1,6)
		liftPart.Anchored = true
		liftPart.Color = Color3.fromRGB(100,255,100)
		liftPart.Parent = workspace

		followConn = RunService.Heartbeat:Connect(function()
			if root and liftPart then
				local footY = root.Position.Y - humanoid.HipHeight - (root.Size.Y/2) - 2
				liftPart.Position = Vector3.new(root.Position.X, footY, root.Position.Z)
			end
		end)
		toggleBtn.Text = "إيقاف "..title
	end

	toggleBtn.MouseButton1Click:Connect(function()
		if building then
			stopBuilding()
		else
			startBuilding()
		end
	end)
end

-- زر V1 Part
local v1Btn = createMainButton("SZ STORE V1",0.1)
v1Btn.MouseButton1Click:Connect(function()
	v1Btn:Destroy()
	createPartMenu("V1")
end)

-- زر V2 Part
local v2Btn = createMainButton("SZ STORE V2",0.25)
v2Btn.MouseButton1Click:Connect(function()
	v2Btn:Destroy()
	createPartMenu("V2")
end)

-- زر ESP
local espBtn = createMainButton("ESP Player",0.4)

-- زر Infinite Jump
local infJumpBtn = createMainButton("Infinite Jump",0.55)

-- زر X-Ray
local xrayBtn = createMainButton("X-Ray",0.7)

--================= وظائف الأزرار =================--

-- ESP
local function addESPToCharacter(char, name)
	local billboard = Instance.new("BillboardGui")
	billboard.Size = UDim2.new(0,100,0,20)
	billboard.AlwaysOnTop = true
	billboard.Adornee = char:WaitForChild("Head")
	billboard.Parent = char

	local nameLabel = Instance.new("TextLabel")
	nameLabel.Size = UDim2.new(1,0,1,0)
	nameLabel.BackgroundTransparency = 1
	nameLabel.Text = name
	nameLabel.TextColor3 = Color3.fromRGB(0,255,0)
	nameLabel.Font = Enum.Font.SourceSansBold
	nameLabel.TextScaled = true
	nameLabel.Parent = billboard
end

local function enableESP()
	for _,plr in pairs(game.Players:GetPlayers()) do
		if plr ~= player and plr.Character then
			addESPToCharacter(plr.Character, plr.Name)
		end
		plr.CharacterAdded:Connect(function(char)
			addESPToCharacter(char, plr.Name)
		end)
	end
end

espBtn.MouseButton1Click:Connect(function() enableESP() espBtn:Destroy() end)

-- Infinite Jump
local infiniteJumpActive = false
infJumpBtn.MouseButton1Click:Connect(function()
	infiniteJumpActive = true
	UserInputService.JumpRequest:Connect(function()
		if infiniteJumpActive then
			local char = player.Character
			if char then
				local humanoid = char:FindFirstChildWhichIsA("Humanoid")
				if humanoid then
					humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
				end
			end
		end
	end)
	infJumpBtn:Destroy()
end)

-- X-Ray
local xrayEnabled = false
xrayBtn.MouseButton1Click:Connect(function()
	xrayEnabled = not xrayEnabled
	for _,obj in pairs(workspace:GetDescendants()) do
		if obj:IsA("BasePart") and obj.Transparency < 1 then
			if xrayEnabled then
				obj.LocalTransparencyModifier = 0.5
			else
				obj.LocalTransparencyModifier = 0
			end
		end
	end
end)
